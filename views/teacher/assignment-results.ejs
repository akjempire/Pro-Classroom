<% layout('layouts/boilerplate') %>

<div class="results-container mt-4">

  <!-- Back button -->
  <div class="mb-3">
    <% if (classroom) { %>
      <a href="/teacher/class/<%= classroom._id %>" class="btn btn-back">
        ← Back to Classroom
      </a>
    <% } else { %>
      <a href="/teacher/dashboard" class="btn btn-back">
        ← Back to Dashboard
      </a>
    <% } %>
  </div>

  <% if (report) { %>
    <!-- Report Info -->
    <div class="report-info shadow-sm">
      <p><strong>Plagiarism check performed on:</strong> 
        <%= report.generatedAt.toLocaleString() %></p>
      <p><strong>Potential issues found:</strong> 
        <span class="badge badge-issues"><%= report.results.length %></span>
      </p>
    </div>

    <!-- Results Table -->
    <div class="card shadow-sm results-card">
      <div class="card-header">
        <h5 class="mb-0">Plagiarism Report</h5>
      </div>
      <div class="table-responsive">
        <table class="table table-hover table-bordered mb-0">
          <thead>
            <tr>
              <th>Student 1</th>
              <th>Student 2</th>
              <th>Similarity</th>
            </tr>
          </thead>
          <tbody>
            <% report.results.forEach(c => { %>
              <tr class="<%= c.similarity > 80 ? 'high-risk' : 'medium-risk' %>">
                <td><%= c.student1.username %></td>
                <td><%= c.student2.username %></td>
                <td><strong><%= c.similarity %>%</strong></td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    </div>

  <% } else { %>
    <!-- No report found -->
    <div class="no-report shadow-sm">
      No plagiarism report available yet. Run the check to generate one.
    </div>
  <% } %>
</div>
