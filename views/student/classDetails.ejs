<% layout('layouts/boilerplate') %>

<div class="class-container" style="max-width: 900px; margin: auto; padding: 2rem;">

  <!-- Class Info -->
  <h2><%= classroom.name %></h2>
  <p><strong>Subject:</strong> <%= classroom.subject %></p>
  <p><strong>Teacher:</strong> <%= classroom.teacher.name %> | <%= classroom.teacher.email %></p>

  <hr style="margin: 2rem 0;" />

  <!-- Assignments -->
  <% assignments.forEach(assignment => { 
    const submission = submissionMap[assignment._id.toString()];
%>
 <li style="margin-bottom: 2rem; padding: 1rem; border: 1px solid #ccc; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
   <h4><%= assignment.title %></h4>
   <p><%= assignment.description %></p>
   <p><strong>Deadline:</strong> <%= new Date(assignment.deadline).toLocaleString() %></p>

   <% if (assignment.assignmentFile && assignment.assignmentFile.url) { %>
     <% if (assignment.assignmentFile.url.endsWith('.pdf')) { %>
       <div style="margin-top: 1rem;">
         <iframe src="<%= assignment.assignmentFile.url %>" width="100%" height="600px" style="border: none;"></iframe>
       </div>
     <% } else { %>
       <p>
         <a href="<%= assignment.assignmentFile.url %>" target="_blank">
           Download <%= assignment.assignmentFile.originalName %>
         </a>
       </p>
     <% } %>
   <% } else { %>
     <p>No file available for this assignment.</p>
   <% } %>

   <% if (submission) { %>
     <!-- ðŸ‘‡ Submitted Info -->
     <p style="color: green;"><strong>Submitted</strong></p>
     <p><strong>File Name:</strong> <%= submission.fileUrl.filename %></p>
     <a href="<%= submission.fileUrl.url %>" target="_blank" style="background-color: #007bff; color: white; padding: 0.4rem 0.8rem; border-radius: 5px; text-decoration: none;">View Submission</a>
   <% } else { %>
     <!-- ðŸ‘‡ Submission Form -->
     <form 
       action="/student/class/<%= classroom._id %>/submit?assignmentId=<%= assignment._id %>" 
       method="POST" 
       enctype="multipart/form-data" 
       style="margin-top: 1rem; display: flex; align-items: center; gap: 1rem;"
     >
       <input type="file" name="submission[file]" required />
       <button 
         type="submit" 
         style="background-color: #28a745; color: white; border: none; padding: 0.5rem 1rem; border-radius: 5px;"
       >
         Submit
       </button>
     </form>
   <% } %>
 </li>
<% }) %>


</div>
